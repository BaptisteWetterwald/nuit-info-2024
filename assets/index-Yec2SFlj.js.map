{"version":3,"file":"index-Yec2SFlj.js","sources":["../../src/script_captcha.js"],"sourcesContent":["import people from './guys.json';\r\n\r\nlet gun = document.querySelector('#gun');\r\nlet grid = document.querySelector('#grid-container');\r\nlet winningGuy;\r\nlet hint;\r\n\r\nsetUp();\r\n\r\nfunction setUp(){\r\n    winningGuy = people[Math.floor(Math.random() * people.length)];\r\n\r\n    // refill the grid with all the guys\r\n    grid.innerHTML = '';\r\n    people.forEach(person => {\r\n        let item = document.createElement('div');\r\n        item.classList.add('grid-item');\r\n        let img = document.createElement('img');\r\n        img.src = `images/${person.nom}.png`;\r\n        img.alt = `Photo ${person.nom}`;\r\n        item.appendChild(img);\r\n        grid.appendChild(item);\r\n    });\r\n\r\n    document.querySelectorAll('.grid-item').forEach(item => {\r\n        item.addEventListener('click', event => {\r\n            // Make the gun shoot by rotating it a bit from its actual position, then back to original position\r\n            let angle = Math.atan2(event.clientY - gun.offsetTop, event.clientX - gun.offsetLeft);\r\n            gun.style.transform = `rotate(${angle - 0.5}rad)`;\r\n            // make the item unclickable\r\n            item.style.pointerEvents = 'none';\r\n            setTimeout(() => {\r\n                gun.style.transform = `rotate(${angle}rad)`;\r\n            }, 100);\r\n    \r\n            // Play the sound\r\n            let audio = new Audio('pew.flac');\r\n            audio.play();\r\n\r\n            // Remove the clicked item after 0.5s\r\n            setTimeout(() => {\r\n                item.remove();\r\n                // checkwin after 0.01s\r\n                setTimeout(checkWin, 10);\r\n            }, 400);\r\n            \r\n        });\r\n    });\r\n\r\n    document.addEventListener('mousemove', event => {\r\n        let angle = Math.atan2(event.clientY - gun.offsetTop, event.clientX - gun.offsetLeft);\r\n        gun.style.transform = `rotate(${angle}rad)`;\r\n    });\r\n\r\n    generateNewHint();\r\n\r\n}\r\n\r\nfunction checkWin() {\r\n    let remaining = document.querySelectorAll('.grid-item');\r\n    // check if the winning guy is still in the grid\r\n    let stillIn = false;\r\n    remaining.forEach(item => {\r\n        if (item.querySelector('img').src.includes(winningGuy.nom)) {\r\n            stillIn = true;\r\n        }\r\n    });\r\n\r\n    if (!stillIn) {\r\n        alert(\"Soit t'es un bot, soit t'es idiotte ! Bref, t'as perdu.\");\r\n        setUp();\r\n    }\r\n    else if (remaining.length === 1) {\r\n        alert(\"Bravo, t'as gagné ! Je te présente \" + winningGuy.nom + \" !\");\r\n        // redirect to ../map.html after 3s\r\n        setTimeout(() => {\r\n            window.location.href = './map.html';\r\n        }, 1000);\r\n    }\r\n    else if (shouldGenerateNewHint()){\r\n        generateNewHint();\r\n    }\r\n}\r\n\r\nfunction shouldGenerateNewHint(){\r\n    let currentHint = hint;\r\n    console.log(\"Current hint : \" + currentHint.field + \" - \" + currentHint.value);\r\n    \r\n    // We should generate a new hint if the current one is the same value for both the winning guy and all the remaining guys\r\n    \r\n    let remaining = document.querySelectorAll('.grid-item');\r\n    let sameValue = true;\r\n\r\n    remaining.forEach(item => {\r\n        let img = item.querySelector('img');\r\n        let person = people.find(p => img.src.includes(p.nom));\r\n        if (person.caracteristiques[currentHint.field] !== currentHint.value){\r\n            sameValue = false;\r\n        }\r\n    });\r\n\r\n    console.log(\"shouldGenerateNewHint : \" + sameValue);\r\n\r\n    return sameValue;\r\n}\r\n\r\nfunction generateNewHint(){\r\n    let fields = Object.keys(winningGuy.caracteristiques);\r\n    let chosenField = fields[Math.floor(Math.random() * fields.length)];\r\n    let newHint = {\r\n        field: chosenField,\r\n        value: winningGuy.caracteristiques[chosenField]\r\n    };\r\n\r\n    hint = newHint;\r\n\r\n    if (shouldGenerateNewHint()){\r\n        generateNewHint();\r\n    }\r\n\r\n    else{\r\n        let hintElement = document.querySelector('#hint');\r\n        hintElement.innerHTML = getHint(hint.field, hint.value);\r\n    }\r\n    \r\n    console.log(\"Generated new hint : \" + hint.field + \" - \" + hint.value);\r\n}\r\n\r\nfunction getHint(field, value){\r\n    let res = \"Indice : \";\r\n    switch(field){\r\n        case \"lunettes\":\r\n            res += value ? \"Je porte des lunettes.\" : \"Je ne porte pas de lunettes.\";\r\n            break;\r\n        case \"barbe\":\r\n            res += value ? \"Je porte une barbe.\" : \"Je ne porte pas de barbe.\";\r\n            break;\r\n        case \"tenue_foncee\":\r\n            res += value ? \"Je porte une tenue foncée.\" : \"Je porte une tenue claire.\";\r\n            break;\r\n        case \"calvitie\":\r\n            res += value ? \"J'ai une calvasse.\" : \"J'ai tous mes cheveux... pour l'instant.\";\r\n            break;\r\n        case \"bras_croises\":\r\n            res += value ? \"Je croise les bras.\" : \"Je ne croise pas les bras.\";\r\n            break;\r\n        case \"chemise\":\r\n            res += value ? \"Je porte une chemise.\" : \"Je porte un polo.\";\r\n            break;\r\n        case \"sourire_bien_marque\":\r\n            res += value ? \"Je souris bien fort.\" : \"Je ne souris pas vraiment.\";\r\n            break;\r\n    };\r\n    /*\r\n            \"lunettes\": true,\r\n            \"barbe\": true,\r\n            \"tenue_foncee\": false,\r\n            \"calvitie\": true,\r\n            \"bras_croises\": true,\r\n            \"chemise\": true,\r\n            \"sourire_bien_marque\": true\r\n    */\r\n    return res;\r\n}"],"names":["gun","grid","winningGuy","hint","setUp","people","person","item","img","event","angle","checkWin","generateNewHint","remaining","stillIn","shouldGenerateNewHint","currentHint","sameValue","p","fields","chosenField","hintElement","getHint","field","value","res"],"mappings":"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"}